# graphlet-clustering

## Find significant modules using PASCAL

The DREAM challenge uses the framework of Pascal to asses the significance of modules found in an Interactome by an algorithm (See https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1004714 ).

To run Pascal for a given DREAM challenge interactome,
provide the following three parameters 
- Path to the modules directory (relative to the current directory). 
- Path to the output directory (relative to the current directoy). The directory will be created if it does not exist. This is where the output from pascal will be saved.
- Which PPI to use (for leaderboard settings). Enter 1 for string, 2 for inweb.

### Example:
```
sh run_pascal.sh ../../out/1_ppi_string ../../out/pascaloutput_1_ppi_string 1
```

See Pascal manual for more details. 

The DREAM challenge also finds the number of significant modules in a given clustering after correcting for multiple hypothesis testing. The python code for doing this is `../../data/DREAM/5_scoring_tools/Scoring_scripts/multiple_testing.py` which uses as input the output generated by Pascal.

## Hypergeometric Test
To assess the significance of modules using datasets on disease associated genes we perform a hypergeomtric test to compute the p-values for overrepresentation of disease genes in modules. For each clustering, we obtain the number of significant modules as well as the number of diseases significantly associated with these modules.

The python code `hg.py` performs this enrichment analysis. To run, provide the following arguments:

- Path to the directory. This is where all the clusters generated by `graphlet_clustering.py` for the given interactome are stored.
- Path to disease - gene association file. This is a tab separated file where the first column is the disease ID, the second column is the disease name and the last column is gene name.
- Inflation.

### Example 
To run with PPI-Pathways_ppi interactome and `ppi_DG.tsv` disease associations:

`hg.py ../../out/PP-Pathways_ppi/ ../../data/snap/ppi_DG.tsv 3.0`

## Analysis

`analysis.py` performs downstream analysis of clustering results and generates various network properties and correlations. Figures (SXX, .. ) in the paper are produced using this code. 

It requires 4 arguments to run:

- Path to the directory containing graphlet specific network and cluster files(generated by `graphlet_clustering.py`). 
- Path to the output directory (to save the output files). This directory will be created, if it does not already exist.
- Graphlet size (it is either 4 or 5).
- Inflation parameter used in `mcl`. The output cluster files of `mcl` contain the inflation parameter in their names, thus it is required to read those files.

### Example:
`python analysis.py ../../out/2_ppi_inweb/ ../../out/ 5 4.0`

